import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o as i,c as t,d,a as e,b as a,e as n,f as c}from"./app-e6e601b2.js";const h={},o=e("h1",{id:"部署專案到-aws-並使用-vpc-elb",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#部署專案到-aws-並使用-vpc-elb","aria-hidden":"true"},"#"),a(" 部署專案到 AWS 並使用 VPC ELB")],-1),l=e("h2",{id:"前言",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),a(" 前言")],-1),u=e("p",null,[a("由於工作中需要把專案部署到 AWS"),e("br"),a(" 這篇文章就當作是個步驟筆記吧")],-1),m=c(`<h2 id="部署目標" tabindex="-1"><a class="header-anchor" href="#部署目標" aria-hidden="true">#</a> 部署目標</h2><p>本次目的是把前後端專案都部署到 AWS 上，使用 VPC 、 ELB 、 EC2 、 RDS 等服務。</p><p>但本次教學還不會用上 Auto Scaling ，這意味著不會自動擴展。</p><p>如果沒有使用 Amazon EC2 Auto Scaling 就要自己手動管理 EC2。</p><ul><li>VPC：虛擬私有網路，將專案服務都集中在虛擬私有網路獨立起來便於管理，對於安全性也比較好</li><li>ELB：負載平衡，根據流量自動導向負荷較低的服務</li><li>EC2：虛擬機會開兩台，一台跳板主機開放 ssh port 跳到專案機，一台專案主機不對外只開放 http 和 https 的 port</li><li>RDS：後端專案的資料庫</li></ul><h2 id="建立-vpc" tabindex="-1"><a class="header-anchor" href="#建立-vpc" aria-hidden="true">#</a> 建立 VPC</h2><p><a href="2024-07-21-vpc.png"></a></p><p>2 個公有子網路<br> 2 個私有子網路<br> NAT 閘道為每個可用區域</p><p>NAT 閘道選無，因為是用自己的帳號所以想當免費仔。<br> 實際上根據自己專案需求來選擇。</p><h2 id="建立-ec2" tabindex="-1"><a class="header-anchor" href="#建立-ec2" aria-hidden="true">#</a> 建立 EC2</h2><h3 id="跳板主機的安全群組" tabindex="-1"><a class="header-anchor" href="#跳板主機的安全群組" aria-hidden="true">#</a> 跳板主機的安全群組</h3><p><a href="2024-07-21-security-groups-ssh.png"></a></p><p><code>pamis-project-ssh</code>：允許 ssh port 連入<br> 建立跳板主機的安全群組，VPC 要選剛剛建立的。</p><h3 id="跳板主機" tabindex="-1"><a class="header-anchor" href="#跳板主機" aria-hidden="true">#</a> 跳板主機</h3><p>建立跳板主機</p><p><a href="./2024-07-21-ec2-jump-1.png"></a></p><p>重點是網路的部分<br> VPC 一定要選對<br> 子網路要選 <code>public</code> 不然外面連不進來<br> 啟用自動指派公有 IP (注：如果想用彈性 IP 也行)<br> 常見安全群組則是選剛剛建立的 <code>pamis-project-ssh</code></p><h3 id="專案主機的安全群組" tabindex="-1"><a class="header-anchor" href="#專案主機的安全群組" aria-hidden="true">#</a> 專案主機的安全群組</h3><p>建立安全群組 <code>pamis-project-http</code>：允許 http 和 https 連入</p><p><a href="2024-07-21-security-groups-http.png"></a></p><p>建立安全群組 <code>pamis-project-jump</code>：允許 跳板主機 連入</p><p>這裡比較特別，需要填入跳板機的私有 IP 。</p><p><a href="./2024-07-21-security-groups-jump.png"></a></p><p><a href="./2024-07-21-ec2-jump-2.png"></a></p><h3 id="專案主機" tabindex="-1"><a class="header-anchor" href="#專案主機" aria-hidden="true">#</a> 專案主機</h3><p>建立專案主機</p><p><a href="./2024-07-21-ec2.png"></a></p><p>重點也還是網路的部分<br> VPC 一定要選對<br> 子網路要選 <code>private</code> 不然會對外暴露，跳板機就白開了<br> 不要啟用自動指派公有 IP<br> 常見安全群組則是選剛剛建立的 <code>pamis-project-http</code> 與 <code>pamis-project-jump</code></p><h3 id="測試連線" tabindex="-1"><a class="header-anchor" href="#測試連線" aria-hidden="true">#</a> 測試連線</h3><p>參考以下設定</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># pamis-project-ec2-jump</span>
Host pamis-project-ec2-jump
	HostName <span class="token number">18.182</span>.31.165
	User ubuntu
    PreferredAuthentications publickey
	IdentityFile ~/.ssh/pamis-dev-aws.pem

<span class="token comment"># pamis-project-ec2</span>
Host pamis-project-ec2
	HostName <span class="token number">10.0</span>.137.3
	User ubuntu
	Proxyjump pamis-project-ec2-jump
    PreferredAuthentications publickey
	IdentityFile ~/.ssh/pamis-dev-aws.pem
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Proxyjump 就是設定要用哪個跳板主機來登入</p><p>連到跳板主機</p><p><a href="./2024-07-21-ssh-ec2-jump.png"></a></p><p>連到專案主機</p><p><a href="./2024-07-21-ssh-ec2.png"></a></p><p>如果出現以上訊息就代表步驟都正確</p><h2 id="建立目標群組" tabindex="-1"><a class="header-anchor" href="#建立目標群組" aria-hidden="true">#</a> 建立目標群組</h2><p>目標群組在 EC2 側邊選單下面</p><p><a href="./2024-07-21-target-group-1.png"></a></p><p>重點一樣選對 VPC</p><p><a href="./2024-07-21-target-group-2.png"></a></p><p>下一步會看到這個注冊頁面</p><p>選擇專案主機</p><p><a href="./2024-07-21-target-group-3.png"></a></p><h2 id="建立負載平衡器" tabindex="-1"><a class="header-anchor" href="#建立負載平衡器" aria-hidden="true">#</a> 建立負載平衡器</h2><p>終於最後一步驟</p><p><a href="./2024-07-21-elb-1.png"></a></p><p>這邊設定要留意的比較多<br> 重點一樣選對 VPC<br> 然後把兩個子網路都打勾<br> 安全群組選 http</p><p><a href="./2024-07-21-elb-2.png"></a></p><p>以上步驟就完成了</p><h2 id="參考資料" tabindex="-1"><a class="header-anchor" href="#參考資料" aria-hidden="true">#</a> 參考資料</h2>`,52),b={href:"https://docs.aws.amazon.com/zh_tw/vpc/latest/userguide/what-is-amazon-vpc.html",target:"_blank",rel:"noopener noreferrer"},v=e("br",null,null,-1),f={href:"https://docs.aws.amazon.com/zh_tw/autoscaling/ec2/userguide/tutorial-ec2-auto-scaling-load-balancer.html",target:"_blank",rel:"noopener noreferrer"};function g(_,x){const r=s("ExternalLinkIcon");return i(),t("div",null,[o,l,u,d(" more "),m,e("p",null,[e("a",b,[a("什麼是 Amazon VPC？"),n(r)]),v,e("a",f,[a("教學課程：設定擴展和負載平衡應用程式"),n(r)])])])}const P=p(h,[["render",g],["__file","index.html.vue"]]);export{P as default};
