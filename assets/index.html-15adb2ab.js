import{_ as d}from"./plugin-vue_export-helper-c27b6911.js";import{r as a,o as i,c as s,d as l,a as e,b as r,e as t,f as o}from"./app-9034c1ad.js";const c="/assets/2024-02-25-01-d9f75485.jpg",h={},_=o('<h1 id="鍵盤掃描碼" tabindex="-1"><a class="header-anchor" href="#鍵盤掃描碼" aria-hidden="true">#</a> 鍵盤掃描碼</h1><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>本文主要探討 <code>keybd_event</code> 函式，<br> 坊間許多的按鍵精靈都會有相關的範例。<br> 由於 <code>keybd_event</code> 比起其他 <code>SendMessage</code>、<code>PostMessage</code> 等函式更為底層，<br> 所以在撰寫上都比較推薦用 <code>keybd_event</code> 來做鍵盤訊號的模擬。</p>',3),b=e("h2",{id:"鍵盤虛擬碼與鍵盤掃描碼",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#鍵盤虛擬碼與鍵盤掃描碼","aria-hidden":"true"},"#"),r(" 鍵盤虛擬碼與鍵盤掃描碼")],-1),p={href:"https://learn.microsoft.com/zh-tw/windows/win32/api/winuser/nf-winuser-keybd_event",target:"_blank",rel:"noopener noreferrer"},u=o(`<div class="language-C++ line-numbers-mode" data-ext="C++"><pre class="language-C++"><code>void keybd_event(
  [in] BYTE      bVk,
  [in] BYTE      bScan,
  [in] DWORD     dwFlags,
  [in] ULONG_PTR dwExtraInfo
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bVk 是鍵盤虛擬碼<br> bScan 是鍵盤掃描碼<br> dwFlags 控制函式作業的各種層面。 此參數可以是下列一或多個值。</p><table><thead><tr><th>值</th><th>意義</th></tr></thead><tbody><tr><td>KEYEVENTF_EXTENDEDKEY 0x0001</td><td>如果指定，掃描碼前面會加上前置詞位元組。</td></tr><tr><td>KEYEVENTF_KEYUP 0x0002</td><td>如果指定，則會釋放掃描碼訊號。如果未指定，按鍵持續按下。</td></tr></tbody></table><p>一般的按鍵腳本通常用鍵盤虛擬碼就可以起作用<br> 所以許多網路上的教學都使用 <code>System.Windows.Forms</code> 的 <code>Keys</code> 列舉傳入 <code>bVk</code><br> 然後 <code>bScan</code> 都直接說傳入 0 即可。</p><p>事實上也不能說是錯的，因為許多電腦應用程式是可以生效的，<br> 但對於一些遊戲，如果沒有傳入掃描碼不會有作用，<br> 原因是有些遊戲接收的訊號是硬體訊號，<br> 特別是跨平台或以家機為主開發的遊戲。</p><h2 id="鍵盤掃描碼與鍵盤驅動的關係" tabindex="-1"><a class="header-anchor" href="#鍵盤掃描碼與鍵盤驅動的關係" aria-hidden="true">#</a> 鍵盤掃描碼與鍵盤驅動的關係</h2><p>那麼為什麼要這麼麻煩分成兩個呢？</p><p>由於歷史因素，各家生產的鍵盤的硬體訊號會有不同，<br> 像是以前的鍵盤是 PS/2 規格的。<br><img src="`+c+'" alt="現在看過的都是老人了" loading="lazy"></p><p>但作業系統不可能知道所有鍵盤的訊號，<br> 所以需要鍵盤驅動來做轉換，<br> 順序大致如下：</p><ol><li>使用者按下鍵盤的某個按鍵</li><li>鍵盤控制器發送硬體訊號到作業系統，這裡的硬體訊號就是掃描碼</li><li>掃描碼輸入到作業系統</li><li>作業系統接收到掃描碼</li><li>作業系統轉發掃描碼到鍵盤驅動</li><li>鍵盤驅動轉換為鍵盤虛擬碼</li></ol><h2 id="鍵盤掃描碼怎麼查" tabindex="-1"><a class="header-anchor" href="#鍵盤掃描碼怎麼查" aria-hidden="true">#</a> 鍵盤掃描碼怎麼查</h2><p>還好經歷時代洪流，那些神奇規格的鍵盤都死得差不多了。</p>',12),f=e("br",null,null,-1),m={href:"https://wiki.osdev.org/PS/2_Keyboard",target:"_blank",rel:"noopener noreferrer"},v=e("h2",{id:"結論",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#結論","aria-hidden":"true"},"#"),r(" 結論")],-1),w=e("p",null,[r("坊間的網路教學都說 "),e("code",null,"bScan"),r(" 都傳入 0 即可。"),e("br"),r(" 但知道了掃描碼的由來與作用，"),e("br"),r(" 這邊還是建議撰寫時可以傳入對應的數值。")],-1),k=e("h2",{id:"參考資料",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#參考資料","aria-hidden":"true"},"#"),r(" 參考資料")],-1),g={href:"https://learn.microsoft.com/zh-tw/windows/win32/api/winuser/nf-winuser-keybd_event",target:"_blank",rel:"noopener noreferrer"},x=e("br",null,null,-1),y={href:"https://learn.microsoft.com/zh-tw/windows/win32/inputdev/virtual-key-codes",target:"_blank",rel:"noopener noreferrer"},E=e("br",null,null,-1),S={href:"https://learn.microsoft.com/zh-tw/windows/win32/inputdev/about-keyboard-input",target:"_blank",rel:"noopener noreferrer"},V=e("br",null,null,-1),N={href:"https://www.typeboom.com/archives/53/",target:"_blank",rel:"noopener noreferrer"},K=e("br",null,null,-1),P={href:"https://wiki.osdev.org/PS/2_Keyboard",target:"_blank",rel:"noopener noreferrer"};function T(B,Y){const n=a("ExternalLinkIcon");return i(),s("div",null,[_,l(" more "),b,e("p",null,[r("當參考官方文件 "),e("a",p,[r("keybd_event函式 (winuser.h)"),t(n)]),r(" 時會看到語法如下")]),u,e("p",null,[r("目前主流電腦鍵盤按鍵沿用 IBM 的行列矩陣方式佈局排列，稱為掃描矩陣。"),f,r(" 可以用 "),e("a",m,[r("掃描碼對照表"),t(n)]),r(" 來參考。")]),v,w,k,e("p",null,[e("a",g,[r("keybd_event 函式 (winuser.h)"),t(n)]),x,e("a",y,[r("虛擬按鍵代碼"),t(n)]),E,e("a",S,[r("鍵盤輸入概觀"),t(n)]),V,e("a",N,[r("电脑键盘工作原理"),t(n)]),K,e("a",P,[r("PS/2 Keyboard"),t(n)])])])}const F=d(h,[["render",T],["__file","index.html.vue"]]);export{F as default};
