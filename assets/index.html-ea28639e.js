import{_ as d}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as r,c as l,d as c,a as e,b as a,e as n,w as i,f as o}from"./app-e55797fa.js";const h="/assets/meme-01-bb140b26.webp",u={},p=e("h2",{id:"前言",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),a(" 前言")],-1),b=e("p",null,[a("每次登入 Linux 主機都要打密碼，"),e("br"),a(" 常常手殘打錯，所以又要來當懶人了。")],-1),m=e("p",null,[a("透過設定 SSH 金鑰使登入 Linux 主機不需要打密碼，"),e("br"),a(" 本篇教學以 Windows 作業系統連線 Linux 的情境為例子。")],-1),v=e("figure",null,[e("img",{src:h,alt:"真的會很憤怒",tabindex:"0",loading:"lazy"}),e("figcaption",{style:{"font-size":"1rem"}},"真的會很憤怒")],-1),x=e("h2",{id:"事前準備",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#事前準備","aria-hidden":"true"},"#"),a(" 事前準備")],-1),g=e("br",null,null,-1),f=e("br",null,null,-1),_=e("h2",{id:"加入-ssh-金鑰",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#加入-ssh-金鑰","aria-hidden":"true"},"#"),a(" 加入 SSH 金鑰")],-1),k=e("h3",{id:"金鑰建立與設定",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#金鑰建立與設定","aria-hidden":"true"},"#"),a(" 金鑰建立與設定")],-1),y=o(`<h3 id="建立金鑰列表檔案" tabindex="-1"><a class="header-anchor" href="#建立金鑰列表檔案" aria-hidden="true">#</a> 建立金鑰列表檔案</h3><p>在想要連線的 Linux 主機內建立 authorized_keys 檔案</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> .ssh
<span class="token builtin class-name">cd</span> ~/.ssh
<span class="token function">nano</span> authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="填寫金鑰列表檔案" tabindex="-1"><a class="header-anchor" href="#填寫金鑰列表檔案" aria-hidden="true">#</a> 填寫金鑰列表檔案</h3><p>將 Windows 產生的 公鑰複製貼上到 authorized_keys 檔案內</p><h3 id="設定金鑰列表檔案權限" tabindex="-1"><a class="header-anchor" href="#設定金鑰列表檔案權限" aria-hidden="true">#</a> 設定金鑰列表檔案權限</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ~/.ssh
<span class="token function">chmod</span> <span class="token number">700</span> ~/.ssh/
<span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/*
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="進行連線" tabindex="-1"><a class="header-anchor" href="#進行連線" aria-hidden="true">#</a> 進行連線</h2><h3 id="使用命令提示字元" tabindex="-1"><a class="header-anchor" href="#使用命令提示字元" aria-hidden="true">#</a> 使用命令提示字元</h3><p>使用 ssh 進行連線指令<br> 如有多個私鑰 -i 參數指定要使用的私鑰檔：<br> 如果不是使用 SSH 預設的 22 port，可使用 -p 參數指定 port：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> pamis@xxx.xxx.xxx.xxx <span class="token parameter variable">-i</span> C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>pamis<span class="token punctuation">\\</span>.ssh<span class="token punctuation">\\</span>id_rsa_ubuntu
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="使用-visual-studio-code" tabindex="-1"><a class="header-anchor" href="#使用-visual-studio-code" aria-hidden="true">#</a> 使用 Visual Studio Code</h3><h3 id="設定連線設定檔案" tabindex="-1"><a class="header-anchor" href="#設定連線設定檔案" aria-hidden="true">#</a> 設定連線設定檔案</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Host LabServer                              <span class="token comment">#填寫別名</span>
	HostName xxx.xxx.xxx.xxx                <span class="token comment">#主機名稱或是ip位置</span>
	Port                                    <span class="token comment">#如果有指定的Port號</span>
	User username                           <span class="token comment">#登入的使用者名稱</span>
    PreferredAuthentications publickey      <span class="token comment">#首選驗證方式</span>
    IdentityFile ~/.ssh/id_rsa_ubuntu       <span class="token comment">#私鑰路徑</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>實際可參考</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Host 我的主機
    HostName 192.168.100.100
    User pamis
    PreferredAuthentications publickey
    IdentityFile ~/.ssh/id_rsa_ubuntu
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用-putty" tabindex="-1"><a class="header-anchor" href="#使用-putty" aria-hidden="true">#</a> 使用 Putty</h2><p>由於 Putty 只接受 ppk 格式的私鑰<br> 所以需要先匯入現有的私鑰並轉換 ppk 格式</p><h3 id="匯入到-puttygen" tabindex="-1"><a class="header-anchor" href="#匯入到-puttygen" aria-hidden="true">#</a> 匯入到 PuTTYgen</h3><ul><li>點選 Load</li><li>選擇所有檔案並匯入私鑰檔案</li><li>點選 Save private key 另存 .ppk 格式</li></ul><h3 id="設定-putty-連線" tabindex="-1"><a class="header-anchor" href="#設定-putty-連線" aria-hidden="true">#</a> 設定 Putty 連線</h3><ul><li>用戶名稱：Connection &gt; Data &gt; Auto-login username</li><li>私鑰檔案：Connection &gt; SSH &gt; Auth</li><li>記得存檔</li></ul><h2 id="root-登入" tabindex="-1"><a class="header-anchor" href="#root-登入" aria-hidden="true">#</a> root 登入</h2><h3 id="建立資料夾與檔案" tabindex="-1"><a class="header-anchor" href="#建立資料夾與檔案" aria-hidden="true">#</a> 建立資料夾與檔案</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root
<span class="token function">mkdir</span> .ssh
<span class="token builtin class-name">cd</span> .ssh
<span class="token function">nano</span> authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="加入公鑰字串" tabindex="-1"><a class="header-anchor" href="#加入公鑰字串" aria-hidden="true">#</a> 加入公鑰字串</h3><p><a href="#%E5%A1%AB%E5%AF%AB%E9%87%91%E9%91%B0%E5%88%97%E8%A1%A8%E6%AA%94%E6%A1%88">填寫金鑰列表檔案</a></p><h3 id="修改-ssh-的設定" tabindex="-1"><a class="header-anchor" href="#修改-ssh-的設定" aria-hidden="true">#</a> 修改 ssh 的設定</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">nano</span> /etc/ssh/sshd_config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="開放-root-登入" tabindex="-1"><a class="header-anchor" href="#開放-root-登入" aria-hidden="true">#</a> 開放 root 登入</h3><p>在下面加入一行</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#PermitRootLogin prohibit-password
PermitRootLogin yes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="更改完存檔後記得重啟服務" tabindex="-1"><a class="header-anchor" href="#更改完存檔後記得重啟服務" aria-hidden="true">#</a> 更改完存檔後記得重啟服務</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl restart sshd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="重啟錯誤處理" tabindex="-1"><a class="header-anchor" href="#重啟錯誤處理" aria-hidden="true">#</a> 重啟錯誤處理</h3><p>如果重啟失敗出現如下訊息</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Failed to start sshd.service: Unit sshd.service not found.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>則要先將系統與服務管理器啟用 SSH 服務</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> ssh.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,39);function S(A,P){const s=t("RouterLink");return r(),l("div",null,[p,b,m,v,c(" more "),x,e("p",null,[a("要確定 Linux 主機有安裝 SSH 並且開通對應的 Port"),g,a(" 一般預設都是 22 Port"),f,a(" 不會安裝的可以參考文件 "),n(s,{to:"/posts/2022-08-19-install-ubuntu-22.04/"},{default:i(()=>[a("使用 VMware 虛擬機建置 Ubuntu 作業系統")]),_:1})]),_,k,e("p",null,[a("參考文件 "),n(s,{to:"/posts/2022-12-15-setting-ssh-key/"},{default:i(()=>[a("SSH 金鑰建立與設定")]),_:1})]),y])}const E=d(u,[["render",S],["__file","index.html.vue"]]);export{E as default};
