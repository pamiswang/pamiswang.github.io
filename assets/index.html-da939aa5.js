import{_ as r}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as l,c as o,a as e,b as a,e as s,f as i}from"./app-5f138607.js";const d={},c=i(`<h1 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h1><p>使用 Swagger 讓 API 開發有文件化與測試功能<br> 本教學為記錄建置專案過程作為未來再次建置的參考</p><h1 id="建置-laravel-專案" tabindex="-1"><a class="header-anchor" href="#建置-laravel-專案" aria-hidden="true">#</a> 建置 Laravel 專案</h1><p>本次建置的框架版本為 Laravel 10，PHP 版本為 8.1</p><h2 id="安裝-php" tabindex="-1"><a class="header-anchor" href="#安裝-php" aria-hidden="true">#</a> 安裝 PHP</h2><p>[[install_ubuntu_php_8]]</p><h2 id="安裝-composer" tabindex="-1"><a class="header-anchor" href="#安裝-composer" aria-hidden="true">#</a> 安裝 Composer</h2><p>[[install_ubuntu_composer]]</p><h2 id="安裝-laravel-安裝器" tabindex="-1"><a class="header-anchor" href="#安裝-laravel-安裝器" aria-hidden="true">#</a> 安裝 Laravel 安裝器</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">composer</span> global require laravel/installer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="建立-laravel-專案" tabindex="-1"><a class="header-anchor" href="#建立-laravel-專案" aria-hidden="true">#</a> 建立 Laravel 專案</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>laravel new example-app
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,12),p=e("br",null,null,-1),u={href:"https://laravel.com/docs/10.x#your-first-laravel-project",target:"_blank",rel:"noopener noreferrer"},h=e("h1",{id:"導入套件-swagger-ui",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#導入套件-swagger-ui","aria-hidden":"true"},"#"),a(" 導入套件 Swagger-UI")],-1),v=e("h2",{id:"介紹套件-l5-swagger",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#介紹套件-l5-swagger","aria-hidden":"true"},"#"),a(" 介紹套件 L5-Swagger")],-1),g={href:"https://github.com/DarkaOnLine/L5-Swagger",target:"_blank",rel:"noopener noreferrer"},b=e("br",null,null,-1),m={href:"https://github.com/zircote/swagger-php",target:"_blank",rel:"noopener noreferrer"},_=e("br",null,null,-1),k=i(`<h2 id="安裝套件-l5-swagger" tabindex="-1"><a class="header-anchor" href="#安裝套件-l5-swagger" aria-hidden="true">#</a> 安裝套件 L5-Swagger</h2><p>安裝指令要根據目前的框架版本來調整，如果是最新的版本就能不指定版本號直接安裝。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">composer</span> require <span class="token string">&quot;darkaonline/l5-swagger&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,3),w={href:"https://github.com/DarkaOnLine/L5-Swagger/wiki/Installation-&-Configuration",target:"_blank",rel:"noopener noreferrer"},f=i(`<h2 id="初次設定" tabindex="-1"><a class="header-anchor" href="#初次設定" aria-hidden="true">#</a> 初次設定</h2><p>執行指令將 L5-Swagger 的設定和畫面檔案加入專案內</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan vendor:publish <span class="token parameter variable">--provider</span> <span class="token string">&quot;L5Swagger\\L5SwaggerServiceProvider&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>執行之後會多出下面兩個檔案</p><ul><li>全域設定：<code>laravel-project/config/l5-swagger.php</code></li><li>專案畫面：<code>laravel-project/resources/views/vendor/l5-swagger</code></li></ul><h2 id="文件建立" tabindex="-1"><a class="header-anchor" href="#文件建立" aria-hidden="true">#</a> 文件建立</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan l5-swagger:generate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,7),x=e("br",null,null,-1),L=e("br",null,null,-1),q={href:"https://github.com/DarkaOnLine/L5-Swagger/issues/443",target:"_blank",rel:"noopener noreferrer"},S=e("br",null,null,-1),A=i(`<div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Foundation<span class="token punctuation">\\</span>Auth<span class="token punctuation">\\</span>Access<span class="token punctuation">\\</span>AuthorizesRequests</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Foundation<span class="token punctuation">\\</span>Validation<span class="token punctuation">\\</span>ValidatesRequests</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Routing<span class="token punctuation">\\</span>Controller</span> <span class="token keyword">as</span> BaseController<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">OpenApi<span class="token punctuation">\\</span>Attributes</span> <span class="token keyword">as</span> <span class="token constant">OA</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * @OA\\Info(
 *      version=&quot;1.0.0&quot;,
 *      x=<span class="token punctuation">{</span>
 *          &quot;logo&quot;: <span class="token punctuation">{</span>
 *              &quot;url&quot;: &quot;https://via.placeholder.com/190x90.png?text=L5-Swagger&quot;
 *          <span class="token punctuation">}</span>
 *      <span class="token punctuation">}</span>,
 *      title=&quot;L5 OpenApi&quot;,
 *      description=&quot;L5 Swagger OpenApi description&quot;,
 *      @OA\\Contact(
 *          email=&quot;darius@matulionis.lt&quot;
 *      ),
 *     @OA\\License(
 *         name=&quot;Apache 2.0&quot;,
 *         url=&quot;https://www.apache.org/licenses/LICENSE-2.0.html&quot;
 *     )
 * )
 *  @OA\\PathItem(
 *      path=&quot;/&quot;
 * )
 * @OA\\server(
 *      url=L5_SWAGGER_CONST_HOST,
 *      description=&quot;Localhost&quot;
 * )
 *
 */</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Controller</span> <span class="token keyword">extends</span> <span class="token class-name">BaseController</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">AuthorizesRequests</span><span class="token punctuation">,</span> ValidatesRequests<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="進入測試畫面" tabindex="-1"><a class="header-anchor" href="#進入測試畫面" aria-hidden="true">#</a> 進入測試畫面</h2><p>Swagger UI 的設定在 <code>config/l5-swagger.php</code><br> 查看 <code>routes</code> 可得知 Swagger UI 預設的文件路由是 api/documentation<br> 打入網址就會出現一個空的 Swagger UI 畫面，到這邊就算是導入套件完成。</p><h1 id="進階使用-l5-swagger" tabindex="-1"><a class="header-anchor" href="#進階使用-l5-swagger" aria-hidden="true">#</a> 進階使用 L5-Swagger</h1><h2 id="自動建立說明文件" tabindex="-1"><a class="header-anchor" href="#自動建立說明文件" aria-hidden="true">#</a> 自動建立說明文件</h2><p>由於每次改動程式都要下指令才會產生新的文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan l5-swagger:generate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,7),I={href:"https://github.com/DarkaOnLine/L5-Swagger/wiki/Installation-&-Configuration#swaggeropenapi-annotations-and-generating-documentation",target:"_blank",rel:"noopener noreferrer"},O=e("br",null,null,-1),C=e("code",null,"laravel-project/.env",-1),P=e("code",null,"L5_SWAGGER_GENERATE_ALWAYS=true",-1),y=e("h2",{id:"標準語法產生工具",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#標準語法產生工具","aria-hidden":"true"},"#"),a(" 標準語法產生工具")],-1),E=e("p",null,"VScode extension: Swagger-PHP Annotation  可自動生成標準語法，節省時間。",-1),R=e("h2",{id:"註解格式用法參考",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#註解格式用法參考","aria-hidden":"true"},"#"),a(" 註解格式用法參考")],-1),V=e("br",null,null,-1),N={href:"https://zircote.github.io/swagger-php/reference/annotations.html",target:"_blank",rel:"noopener noreferrer"};function j(H,U){const n=t("ExternalLinkIcon");return l(),o("div",null,[c,e("p",null,[a("參考官方教學"),p,e("a",u,[a("Your First Laravel Project"),s(n)])]),h,v,e("p",null,[a("本次要使用的套件為 "),e("a",g,[a("L5-Swagger"),s(n)]),a("，這是一個整合 Laravel 與 Swagger UI 的套件，"),b,a(" 因為底層是基於 "),e("a",m,[a("swagger-php"),s(n)]),a(" 這個專案，原理是透過特定的 PHP 註解寫法自動產生 Swagger UI 可以辨識的語法。"),_,a(" 之所以是 L5 是因為最初是為了 Laravel 5 的套件，但目前已經支援 Laravel 10 了。")]),k,e("p",null,[a("詳細的安裝教學或其他版本的設定需要參閱官方安裝教學："),e("a",w,[a("Installation"),s(n)])]),f,e("p",null,[a("初次執行會出現類似下方的錯誤"),x,a(" ![[laravel_swagger_ui_1.jpg]]"),L,a(" 這是因為沒有在 Controllers 加上 OA 規範，詳細可參考 "),e("a",q,[a("Required @OA\\Info() not found"),s(n)]),S,a(" 以下為參考範例")]),A,e("p",null,[a("因此官方建議可以透過環境設定來改為自動產生 "),e("a",I,[a("Swagger/OpenApi annotations and generating documentation"),s(n)]),O,a(" 在 "),C,a(" 內 加入 "),P]),y,E,R,e("p",null,[a("可參考此手冊"),V,e("a",N,[a("https://zircote.github.io/swagger-php/reference/annotations.html"),s(n)])])])}const G=r(d,[["render",j],["__file","index.html.vue"]]);export{G as default};
