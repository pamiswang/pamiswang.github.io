import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as d,c,d as t,a,b as e,e as l,f as r}from"./app-dd9f92ad.js";const o="/assets/2024-06-10-01-835d2852.png",p="/assets/2024-06-10-02-e895494f.png",u={},h=a("h1",{id:"在-ubuntu-安裝-php-8-與-apache",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#在-ubuntu-安裝-php-8-與-apache","aria-hidden":"true"},"#"),e(" 在 Ubuntu 安裝 PHP 8 與 Apache")],-1),v=a("h2",{id:"前言",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),e(" 前言")],-1),m=a("p",null,[e("雖然平常都是用 PHP 搭配 Nginx"),a("br"),e(" 但有時候還是會用到 Apache"),a("br"),e(" 設定上也是很方便")],-1),b=r(`<h2 id="使用官方套件庫安裝" tabindex="-1"><a class="header-anchor" href="#使用官方套件庫安裝" aria-hidden="true">#</a> 使用官方套件庫安裝</h2><h3 id="安裝-apache" tabindex="-1"><a class="header-anchor" href="#安裝-apache" aria-hidden="true">#</a> 安裝 Apache</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> apache2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安裝-php" tabindex="-1"><a class="header-anchor" href="#安裝-php" aria-hidden="true">#</a> 安裝 PHP</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> php
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libapache2-mod-php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="撰寫-php" tabindex="-1"><a class="header-anchor" href="#撰寫-php" aria-hidden="true">#</a> 撰寫 PHP</h2><p>首先在 <code>/var/www</code> 新增一個 <code>index.php</code><br> 程式碼參考下方片段</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="設定-apache" tabindex="-1"><a class="header-anchor" href="#設定-apache" aria-hidden="true">#</a> 設定 Apache</h2><h3 id="撰寫設定檔案" tabindex="-1"><a class="header-anchor" href="#撰寫設定檔案" aria-hidden="true">#</a> 撰寫設定檔案</h3><p>可以參考 <code>000-default.conf</code> 的設定來修改一個執行 PHP 的範例</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>80</span><span class="token punctuation">&gt;</span></span>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www
    ErrorLog \${APACHE_LOG_DIR}/error.log
    CustomLog \${APACHE_LOG_DIR}/access.log combined
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="啟用設定檔案" tabindex="-1"><a class="header-anchor" href="#啟用設定檔案" aria-hidden="true">#</a> 啟用設定檔案</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ln</span> <span class="token parameter variable">-s</span> /etc/apache2/sites-available/0-default.conf /etc/apache2/sites-enabled/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>這邊解釋一下 <code>ln -s</code> 是建立符號連結，類似 Windows 捷徑的概念。<br> 透過在 ites-enabled 建立捷徑來決定哪些網站設定要被啟用。</p><p>設定完畢後重啟伺服器</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl restart apache2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="執行-php-查看網頁" tabindex="-1"><a class="header-anchor" href="#執行-php-查看網頁" aria-hidden="true">#</a> 執行 PHP 查看網頁</h2><p>如果步驟正確理論上就會出現 PHP 版本資訊的畫面了</p><figure><img src="`+o+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="設定-apache-權限" tabindex="-1"><a class="header-anchor" href="#設定-apache-權限" aria-hidden="true">#</a> 設定 Apache 權限</h2><p>安裝 Apache 後設定檔會出現在 <code>/etc/apache2</code> 這個目錄內。</p><h3 id="專案目錄" tabindex="-1"><a class="header-anchor" href="#專案目錄" aria-hidden="true">#</a> 專案目錄</h3><p>打開檔案 <code>/etc/apache2/apache2.conf</code> ，<br> 可以看到以下這段就是說明專案目錄的設定。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code># Sets the default security model of the Apache2 HTTPD server. It does
# not allow access to the root filesystem outside of /usr/share and /var/www.
# The former is used by web applications packaged in Debian,
# the latter may be used for local directories served by the web server. If
# your system is serving content from a sub-directory in /srv you must allow
# access here, or in any related virtual host.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Directory</span> <span class="token punctuation">/&gt;</span></span>
    Options FollowSymLinks
    AllowOverride None
    Require all denied
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>

&lt;Directory /usr/share&gt;
    AllowOverride None
    Require all granted
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>

&lt;Directory /var/www/&gt;
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一般來說 <code>/usr/share</code> 和 <code>/var/www</code> 目錄就是放網頁的，<br> 但有時候一般使用者無法用 <code>root</code> 權限登入，<br> 所以網頁專案會放在 <code>/home/user</code> 等目錄內，<br> 因此可以在複製上方的設定修改，加入自己的專案目錄，<br> 但加入之後還無法正確開啟網頁，還有權限需要設定。</p><h2 id="群組權限" tabindex="-1"><a class="header-anchor" href="#群組權限" aria-hidden="true">#</a> 群組權限</h2><p>許多人頭痛的權限問題，沒有設定好就會出現各種 403 問題。</p><figure><img src="`+p+`" alt="滿滿的403" tabindex="0" loading="lazy"><figcaption style="font-size:1rem;">滿滿的403</figcaption></figure><p>所以要先了解權限設定<br> 打開檔案 <code>/etc/apache2/apache2.conf</code><br> 看到這一段可以知道伺服器的用戶與群組</p><div class="language-conf line-numbers-mode" data-ext="conf"><pre class="language-conf"><code># These need to be set in /etc/apache2/envvars
User \${APACHE_RUN_USER}
Group \${APACHE_RUN_GROUP}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再前往 <code>/etc/apache2/envvars</code> 內查看</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code># Since there is no sane way to get the parsed apache2 config in scripts, some
# settings are defined via environment variables and then used in apache2ctl,
# /etc/init.d/apache2, /etc/logrotate.d/apache2, etc.
export APACHE_RUN_USER=www-data
export APACHE_RUN_GROUP=www-data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以確認到預設使用者為是 <code>www-data</code> ，<br> 所以為了能夠正確讀取我們的網頁，<br> 故需要將指定使用者加入 <code>www-data</code> 群組。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># username 自己替換成指定使用者</span>
<span class="token function">sudo</span> gpasswd <span class="token parameter variable">-a</span> www-data username
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>並確保用戶群組可以進入路徑中的所有目錄</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">chmod</span> g+x /home/pamis <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> g+x /home/pamis/test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>設定完畢後重啟伺服器</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl restart apache2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="參考資料" tabindex="-1"><a class="header-anchor" href="#參考資料" aria-hidden="true">#</a> 參考資料</h2>`,40),g={href:"https://ubuntu.com/server/docs/how-to-install-and-configure-php",target:"_blank",rel:"noopener noreferrer"};function f(k,x){const n=i("ExternalLinkIcon");return d(),c("div",null,[h,v,m,t(" more "),b,a("p",null,[a("a",g,[e("How to install and configure PHP"),l(n)])])])}const P=s(u,[["render",f],["__file","index.html.vue"]]);export{P as default};
